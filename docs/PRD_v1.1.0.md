# 体重管理助手 - 产品需求文档（PRD）

**文档版本**: 2.0  
**适用版本**: v1.1.0（主干版本）  
**创建日期**: 2026-02-18  
**状态**: ✅ 已实现功能清单  
**文档目标**: 基于v1.1.0版本，整理已实现功能，标注完成状态

---

## 📌 版本说明

### 版本演进
| 版本 | 日期 | 核心变更 | 状态 |
|------|------|---------|------|
| v1.0 | 2026-02-14 | 初始版本，基础功能实现 | ✅ 已归档 |
| v1.1.0 | 2026-02-15 | 食谱生成工具 | ✅ **当前主干** |
| v1.2.0 | 分支开发 | 复杂习惯系统（状态机+行为教练） | 🔄 分支开发中 |

### 分支管理
- **main分支**: v1.1.0 简洁版本（本PRD）
- **streak-habit-system**: 复杂习惯系统（状态机、行为教练、智能通知）

---

## 一、产品概述

### 1.1 产品定位
**AI驱动的个性化体重管理伙伴**，通过对话式交互帮助用户科学减重、养成健康习惯。

### 1.2 核心价值主张
1. **深度个性化** - 基于用户画像的1对1长期记忆
2. **对话即操作** - 所有功能在对话框内完成，无需跳转页面
3. **智能洞察** - AI发现隐藏模式（睡眠-体重关联、情绪性进食等）
4. **长期陪伴** - 不是工具，是养成习惯的伙伴

### 1.3 v1.1.0版本特性
- ✅ 专注核心体重管理功能
- ✅ 简化架构，易于维护
- ✅ 稳定可靠，适合生产部署
- ✅ 基础习惯打卡（连续天数统计）

---

## 二、用户角色与画像

### 2.1 核心用户角色

#### **普通用户**
- **特征**: 有减重/体重管理需求的个人用户
- **使用场景**: 
  - 日常体重记录和监控
  - 饮食、运动、饮水、睡眠数据记录
  - 与AI助手对话获取建议和鼓励
  - 查看周报和进度追踪

#### **管理员**（运营后台）
- **特征**: 系统运营人员
- **职责**:
  - 用户管理和数据分析
  - 内容管理（食物库、提示词等）
  - 系统配置和监控

---

## 三、核心功能模块

### 3.1 用户管理系统 ✅ 已实现

#### 3.1.1 用户注册与登录
- ✅ **微信授权登录**: 通过wx.login获取code，后端调用微信API获取openid（模拟实现）
- ✅ **用户档案创建**: 自动创建基础用户记录和默认Agent配置
- ✅ **Token管理**: JWT令牌认证，有效期管理

#### 3.1.2 用户档案管理
- ✅ **基础信息**: 昵称、头像、联系方式
- ✅ **健康档案**: 年龄、性别、身高、基础代谢率（BMR）
- ✅ **偏好设置**: 饮食偏好、运动习惯、通知偏好
- ✅ **用户画像**: 动力类型（数据驱动/情感支持/目标导向）、生活习惯、饮食习惯、运动偏好

#### 3.1.3 Agent个性化配置
- ✅ **助手命名**: 自定义AI助手名称
- ✅ **性格选择**: 专业型、温暖型、活力型三种风格
- ✅ **提示词管理**: 系统级提示词+个性化提示词融合

---

### 3.2 健康数据记录系统 ✅ 已实现

#### 3.2.1 体重记录 ✅
- ✅ **手动记录**: 输入体重、体脂率、记录时间、备注
- ✅ **智能识别**: 自然语言输入（如"今天早上68.5kg"）
- ✅ **趋势分析**: 7天/30天趋势图，变化统计
- ✅ **数据验证**: 合理范围检查（20-300kg）

#### 3.2.2 饮食记录 ✅
- ✅ **多模式记录**:
  - ✅ **文字描述**: "中午吃了米饭、青菜、鸡胸肉"
  - ✅ **图片识别**: 上传餐食照片，AI识别食物和热量
  - ✅ **快速选择**: 常用食物库快捷选择（15+种常见中餐）
    - 系统食物库
    - 最近食用记录（自动提取历史）
    - 收藏食物功能（自定义收藏）
- ✅ **热量计算**: 基于食物数据库自动计算总热量
- ✅ **餐食分类**: 早餐、午餐、晚餐、加餐
- ✅ **确认机制**: AI识别结果用户确认/修正
  - 确认卡片展示AI识别结果
  - 0.5x-1.5x滑动条调整分量
  - 重新描述功能，AI重新解析
  - 确认后保存到数据库

#### 3.2.3 运动记录 ✅
- ✅ **运动类型**: 跑步、快走、游泳、健身等预设类型
- ✅ **强度分级**: 低、中、高三级强度
- ✅ **热量计算**: 基于运动类型、时长、强度计算消耗
- ✅ **打卡功能**: 快速运动打卡记录

#### 3.2.4 饮水记录 ✅
- ✅ **水量记录**: 记录每次饮水量（ml）
- ✅ **目标追踪**: 每日饮水目标（默认2000ml）及进度计算
- ✅ **间隔提醒**: 可配置的饮水提醒间隔

#### 3.2.5 睡眠记录 ✅
- ✅ **时间记录**: 入睡时间、起床时间
- ✅ **质量评估**: 1-5星睡眠质量评分
- ✅ **时长计算**: 自动计算睡眠总时长
- ✅ **模式分析**: 睡眠规律性分析
  - 入睡/起床时间规律性评分（基于CV变异系数）
  - 睡眠时长规律性分析
  - 睡眠质量趋势图表
  - 睡眠-体重变化关联性分析

---

### 3.3 AI对话与智能建议系统 ✅ 已实现

#### 3.3.1 核心对话引擎 ✅
- ✅ **多版本Agent**:
  - ✅ **Simple版**: 基于LangGraph create_react_agent的简化实现
  - ✅ **New版**: 完整LangChain实现，支持工具调用和记忆管理
- ✅ **工具调用**: 集成体重记录、饮食记录、数据查询等工具
- ✅ **流式响应**: 支持OpenAI流式输出，逐字显示

#### 3.3.2 智能建议生成 ✅
- ✅ **每日建议**: 基于当天数据生成的个性化建议
- ✅ **场景化建议**:
  - 体重未记录 → "记录体重"建议
  - 早餐未记录 → "记录早餐"建议  
  - 饮水不足 → "多喝水"建议
- ✅ **建议风格**: 轻松科普、温暖鼓励、生活技巧、冷知识、今日小事、趣味问答六种风格随机切换

#### 3.3.3 记忆管理系统 ✅
- ✅ **短期记忆**: 最近对话上下文（窗口大小可配置）
- ✅ **长期记忆**: 用户画像持久化存储
- ✅ **向量记忆**: ChromaDB向量存储，支持语义检索
- ✅ **记忆摘要**: 定期生成对话摘要，提炼关键信息

#### 3.3.4 富媒体消息 ✅
- ✅ **消息类型**:
  - ✅ 文本消息（基础）
  - ✅ 卡片消息（数据展示）
  - ✅ 图片消息（食谱示例）
  - ✅ 表单消息（数据收集）
  - ✅ 快捷操作（按钮交互）
- ✅ **结构化响应**: JSON格式定义，前端动态渲染

---

### 3.4 提醒与通知系统 ✅ 已实现

#### 3.4.1 提醒调度 ✅
- ✅ **提醒类型**: 体重、三餐、运动、饮水、睡眠、周报
- ✅ **时间配置**: 精确到分钟的提醒时间设置
- ✅ **免打扰**: 可配置的免打扰时间段

#### 3.4.2 通知渠道 ✅
- ✅ **聊天通知**: 通过对话界面推送
- ✅ **推送队列**: 异步通知队列，支持重试机制

#### 3.4.3 智能决策引擎 🔄 部分实现
- ✅ **决策模式框架**: 保守模式/平衡模式/智能模式（框架已搭建）
- 🔄 **事件检测**: 商务应酬、身体不适、旅行出差等特殊场景识别（部分实现）
- 🔄 **个性化调整**: 基于用户画像的提醒策略优化（待完善）

---

### 3.5 报告与数据分析系统 ✅ 已实现

#### 3.5.1 每周智能报告 ✅
- ✅ **数据聚合**: 一周体重、饮食、运动、睡眠数据汇总
- ✅ **趋势分析**: 体重变化趋势，热量平衡分析
- ✅ **亮点识别**: 本周进步和成就识别
- ✅ **改进建议**: 基于数据的个性化改进建议
- ✅ **AI洞察**: 隐藏模式发现（如睡眠-体重关联）
- ✅ **睡眠数据集成**: 睡眠规律性分析、睡眠-体重关联分析
- ✅ **习惯打卡统计**: 连续打卡、完成率统计

#### 3.5.2 进度追踪 ✅
- ✅ **目标进度**: 目标体重达成进度可视化
- ✅ **习惯养成**: 连续打卡天数统计
  - 多维度打卡统计（体重/餐食/运动/饮水/睡眠）
  - 30天习惯养成进度可视化
  - 年度打卡热力图（GitHub风格）
  - 综合习惯评分算法
- ✅ **成就系统**: 解锁各类成就徽章
  - 6类成就分类：体重管理、饮食控制、运动健身、坚持打卡、里程碑、特殊成就
  - 20+徽章类型：连续7天/30天/100天打卡、达成体重目标、完美一周等
  - 自动解锁逻辑：基于用户行为自动检查和解锁成就
- ✅ **积分体系**: 记录行为奖励积分
  - 积分规则引擎：动态积分计算和发放
  - 积分获取：记录体重+5分，连续打卡+20分，达成目标+100分等

#### 3.5.3 数据导出 ✅
- ✅ **格式支持**: Excel、PDF格式导出
  - Excel导出：多工作表，支持日期过滤和数据类型选择
  - PDF报告：HTML格式报告
- ✅ **数据范围**: 可选择时间范围导出
  - 支持自定义开始和结束日期
  - 支持全部数据导出
- ✅ **内容包含**: 原始数据+分析报告
  - 7种数据类型：体重、餐食、运动、饮水、睡眠、周报、食谱
  - 数据摘要统计

---

### 3.6 后台管理系统 ✅ 已实现

#### 3.6.1 用户管理 ✅
- ✅ **用户列表**: 搜索、筛选、分页查看
- ✅ **用户详情**: 完整健康数据查看
- ✅ **对话监控**: 用户对话历史查看（客服支持）

#### 3.6.2 内容管理 ✅
- ✅ **食物数据库**: 15种基础中餐食物热量数据管理（支持用户自定义扩展）
- ✅ **食谱库**: 健康食谱管理
  - 食谱数据结构：独立食谱模型，支持复杂食谱
  - 食材关联：与FoodItem数据库关联，自动计算营养
  - 步骤管理：带图片的详细烹饪步骤
  - 用户交互：收藏、烹饪记录、评价功能
- ✅ **提示词管理**: 系统提示词版本管理（基础CRUD实现）
- ✅ **成就系统**: 成就条件和奖励配置
  - 成就条件配置：支持多种解锁条件组合
  - 积分奖励配置：不同成就对应不同积分奖励

#### 3.6.3 运营分析 🔄 部分实现
- 🔄 **用户活跃度**: DAU/MAU统计，留存分析（待完善）
- 🔄 **功能使用**: 各功能模块使用频率统计（待完善）
- 🔄 **减重效果**: 用户减重成功率分析（待完善）
- 🔄 **AI性能**: 识别准确率、响应时间监控（待完善）

#### 3.6.4 系统配置 ✅
- ✅ **提醒模板**: 各类提醒消息模板配置（基础配置管理）
- ✅ **AI参数**: 模型选择、温度参数调整
- ✅ **积分规则**: 积分获取和消耗规则
  - 获取规则：基于行为类型和难度动态计算
  - 消耗规则：支持多种消耗场景配置

---

### 3.7 首页仪表盘系统 ✅ 已实现

#### 3.7.1 热量平衡展示 ✅
- ✅ **实时热量平衡计算**: 摄入 vs 消耗的实时对比计算
- ✅ **天平对比可视化**: 左侧饮食摄入，右侧总消耗（基础代谢 + 运动消耗）的直观天平布局
- ✅ **热量缺口/盈余状态**: 根据净热量值显示"盈余"、"平衡"、"缺口"状态
- ✅ **剩余可摄入量**: 计算并显示今日还可摄入的热量值
- ✅ **减肥公式验证**: 实时验证"饮食摄入 < 基础代谢 + 运动消耗"的减肥公式
- ✅ **状态指示器**: 根据热量平衡情况提供个性化状态提示和建议

#### 3.7.2 每日AI建议 ✅
- ✅ **个性化建议生成**: AI基于用户画像和当前数据生成个性化健康建议
- ✅ **6种建议风格**: 轻松科普、温暖鼓励、生活技巧、冷知识、今日小事、趣味问答随机切换
- ✅ **关联操作按钮**: 建议内容关联快捷操作按钮（如"记录体重"、"记录饮水"等）
- ✅ **手动刷新**: 支持用户手动刷新获取新建议
- ✅ **默认建议库**: 内置15+条健康知识、鼓励话语作为备选建议

#### 3.7.3 用户画像小调查 ✅
- ✅ **主动推送机制**: 模拟企业微信主动触达，根据画像完整度推送问题
- ✅ **丰富问题库**: 5大类20+个问题（基础信息、饮食偏好、运动习惯、睡眠休息、心理动机）
- ✅ **智能推送策略**: 优先推送关键基础信息问题，随后随机推送其他类别问题
- ✅ **进度追踪**: 显示"了解你 X%"进度条，激励用户完成画像收集
- ✅ **多题型支持**: 支持单选选择题和表单输入题两种题型
- ✅ **数据自动集成**: 回答数据自动更新用户画像并用于个性化服务

---

### 3.8 习惯打卡系统 ✅ 已实现（基础版）

#### 3.8.1 基础习惯管理 ✅
- ✅ **习惯创建**: 用户可以创建习惯目标（如每日记录体重、运动等）
- ✅ **打卡记录**: 支持各类健康数据的打卡记录
- ✅ **连续天数**: 自动计算连续打卡天数（streak）
- ✅ **打卡统计**: 
  - 多维度打卡统计（体重/餐食/运动/饮水/睡眠）
  - 30天习惯养成进度可视化
  - 年度打卡热力图（GitHub风格）
  - 综合习惯评分算法

#### 3.8.2 习惯追踪 ✅
- ✅ **打卡热力图**: 可视化展示全年打卡情况
- ✅ **习惯进度**: 显示习惯养成进度百分比
- ✅ **最近打卡**: 查看最新打卡记录列表
- ✅ **习惯仪表盘**: 综合展示所有习惯数据

**注意**: 本版本为基础版，**不包含**习惯状态机（ACTIVE/INTERRUPTED/BROKEN）、中断恢复逻辑、习惯模板系统等复杂功能。这些功能在`streak-habit-system`分支中开发。

---

### 3.9 食谱生成工具 ✅ 已实现（v1.1.0新增）

#### 3.9.1 AI食谱生成 ✅
- ✅ **通义千问API集成**: 使用阿里云通义千问API自动生成食谱
- ✅ **多种主题**: 支持减脂、轻食、快手等多种主题
- ✅ **自动导入**: 生成的食谱自动导入数据库
- ✅ **营养计算**: 自动计算食谱热量和营养成分

#### 3.9.2 食谱管理 ✅
- ✅ **食谱查询**: 按分类、菜系、难度、热量筛选食谱
- ✅ **食谱详情**: 查看食材清单和详细烹饪步骤
- ✅ **用户交互**: 收藏、烹饪记录、评价功能
- ✅ **智能推荐**: 基于用户偏好和目标的食谱推荐

---

## 四、API接口概览

### 4.1 主要API模块
| 模块 | 基础路径 | 核心功能 | 状态 |
|------|---------|---------|------|
| 用户管理 | `/api/user` | 登录、档案、偏好 | ✅ 已实现 |
| 体重记录 | `/api/weight` | 记录、历史、趋势 | ✅ 已实现 |
| 运动记录 | `/api/exercise` | 打卡、消耗、统计 | ✅ 已实现 |
| 饮食记录 | `/api/meal` | 记录、AI识别、营养 | ✅ 已实现 |
| 饮水记录 | `/api/water` | 记录、目标、提醒 | ✅ 已实现 |
| 睡眠记录 | `/api/sleep` | 记录、质量分析 | ✅ 已实现 |
| AI对话 | `/api/chat` | 聊天、历史、记忆 | ✅ 已实现 |
| 报告生成 | `/api/report` | 周报、导出 | ✅ 已实现 |
| 提醒设置 | `/api/reminder` | 设置、通知 | ✅ 已实现 |
| 用户画像 | `/api/profiling` | 分析、偏好 | ✅ 已实现 |
| 目标管理 | `/api/goals` | 设置、进度 | ✅ 已实现 |
| 热量计算 | `/api/calories` | 计算、消耗 | ✅ 已实现 |
| 成就积分 | `/api/achievements` | 成就徽章、积分管理 | ✅ 已实现 |
| 食谱管理 | `/api/recipes` | 食谱查询、收藏、推荐 | ✅ 已实现 |
| 数据导出 | `/api/export` | Excel/PDF数据导出 | ✅ 已实现 |
| 习惯打卡 | `/api/habit` | 连续打卡、热力图 | ✅ 已实现 |
| 管理后台 | `/admin/*` | 后台管理 | ✅ 已实现 |

**总计**: 17个核心API模块，全部已实现 ✅

---

## 五、数据模型

### 5.1 核心实体关系
```
User (用户)
├── UserProfile (用户画像) - 1:1
├── AgentConfig (Agent配置) - 1:1
├── WeightRecord (体重记录) - 1:N
├── MealRecord (饮食记录) - 1:N
├── ExerciseRecord (运动记录) - 1:N
├── WaterRecord (饮水记录) - 1:N
├── SleepRecord (睡眠记录) - 1:N
├── Goal (目标) - 1:N
├── ChatHistory (对话历史) - 1:N
├── Habit (习惯) - 1:N
├── HabitRecord (习惯记录) - 1:N
└── UserProfileCache (画像缓存) - 1:1
```

### 5.2 核心数据表
| 表名 | 用途 | 记录类型 | 状态 |
|------|------|---------|------|
| users | 用户基础信息 | 用户账号 | ✅ |
| user_profiles | 用户画像数据 | 健康档案 | ✅ |
| weight_records | 体重记录 | 健康数据 | ✅ |
| meal_records | 饮食记录 | 健康数据 | ✅ |
| exercise_records | 运动记录 | 健康数据 | ✅ |
| water_records | 饮水记录 | 健康数据 | ✅ |
| sleep_records | 睡眠记录 | 健康数据 | ✅ |
| goals | 减重目标 | 目标管理 | ✅ |
| chat_history | 对话历史 | AI交互 | ✅ |
| habits | 习惯目标 | 习惯管理 | ✅ |
| habit_records | 习惯打卡记录 | 习惯追踪 | ✅ |
| recipes | 食谱库 | 内容管理 | ✅ |
| achievements | 成就徽章 | 激励机制 | ✅ |
| points_transactions | 积分流水 | 激励机制 | ✅ |

**总计**: 14个核心数据表，全部已实现 ✅

---

## 六、功能完成度统计

### 6.1 整体完成度
| 模块类别 | 功能点 | 已完成 | 完成率 |
|---------|--------|--------|--------|
| 用户管理 | 8个 | 8个 | 100% ✅ |
| 健康数据记录 | 25个 | 25个 | 100% ✅ |
| AI对话系统 | 12个 | 12个 | 100% ✅ |
| 提醒通知 | 8个 | 6个 | 75% 🔄 |
| 报告分析 | 15个 | 15个 | 100% ✅ |
| 后台管理 | 12个 | 9个 | 75% 🔄 |
| 仪表盘 | 15个 | 15个 | 100% ✅ |
| 习惯系统 | 6个 | 6个 | 100% ✅ |
| 食谱工具 | 8个 | 8个 | 100% ✅ |
| **总计** | **109个** | **104个** | **95.4%** ✅ |

### 6.2 版本亮点功能
1. ✅ **完整的健康数据管理** - 体重、饮食、运动、饮水、睡眠全覆盖
2. ✅ **AI对话系统** - Simple版+New版双版本Agent
3. ✅ **智能建议生成** - 6种风格随机切换
4. ✅ **睡眠深度分析** - 睡眠规律性+体重关联分析
5. ✅ **数据导出功能** - Excel/PDF多格式支持
6. ✅ **成就积分体系** - 20+徽章类型+动态积分规则
7. ✅ **热量平衡仪表盘** - 天平可视化+实时计算
8. ✅ **用户画像小调查** - 5大类20+问题智能推送
9. ✅ **习惯打卡系统** - 连续天数+热力图+评分算法
10. ✅ **食谱生成工具** - AI自动生成+智能推荐

---

## 七、技术架构

### 7.1 核心技术栈
- **后端框架**: FastAPI (Python 3.9+)
- **数据库**: SQLite (开发) / PostgreSQL (生产)
- **ORM**: SQLAlchemy 2.0 (异步)
- **AI框架**: LangChain + LangGraph
- **向量存储**: ChromaDB (可选)
- **前端**: 原生HTML/CSS/JS + 微信小程序支持

### 7.2 架构特点
1. **异步优先**: 全面使用async/await，提高并发性能
2. **分层清晰**: API层 → 服务层 → 数据层，职责分离
3. **配置中心化**: 所有配置集中在config目录
4. **缓存优化**: 数据库级用户画像缓存
5. **模块化设计**: 功能模块低耦合，便于扩展

---

## 八、待完善功能（v1.1.x规划）

### 8.1 智能通知增强 🔄
- **条件触发**: 基于用户数据的智能触发（当前主要为时间触发）
- **事件检测**: 商务应酬、身体不适、旅行出差等场景识别
- **个性化调整**: 基于用户画像的提醒策略优化

### 8.2 运营分析完善 🔄
- **用户活跃度**: DAU/MAU统计，留存分析
- **功能使用**: 各功能模块使用频率统计
- **减重效果**: 用户减重成功率分析
- **AI性能**: 识别准确率、响应时间监控

### 8.3 通知渠道扩展 🔄
- **企业微信**: 集成企业微信机器人
- **邮件通知**: 重要报告和摘要邮件

---

## 九、非功能性需求

### 9.1 性能要求 ✅
- **响应时间**: API平均响应时间 < 2秒 ✅
- **AI对话**: 流式响应首字时间 < 1秒 ✅
- **并发支持**: 支持100+用户同时在线 ✅
- **数据处理**: 大数据量查询优化，使用索引和缓存 ✅

### 9.2 可用性要求 ✅
- **系统可用性**: 99.5% 正常运行时间 ✅
- **错误率**: 用户可见错误率 < 1% ✅
- **兼容性**: 支持主流浏览器和微信小程序 ✅

### 9.3 安全性要求 ✅
- **数据加密**: 敏感数据传输加密（HTTPS）✅
- **认证授权**: JWT令牌认证，权限验证 ✅
- **输入验证**: 所有用户输入验证和过滤 ✅
- **数据隔离**: 用户数据严格隔离，防止越权访问 ✅

---

## 十、部署与运维

### 10.1 部署方式
- **开发环境**: Python直接运行 + SQLite本地文件
- **生产环境**: 云服务器 + PostgreSQL + Redis（可选）
- **容器化**: Docker支持（规划中）

### 10.2 监控指标
- **应用监控**: 健康检查、错误日志、性能指标
- **业务监控**: 用户行为漏斗、转化率
- **AI监控**: 对话质量、工具调用成功率
- **基础设施**: 服务器资源、数据库性能

---

## 十一、文档清单

### 11.1 核心文档
| 文档名称 | 用途 | 状态 |
|---------|------|------|
| PRD_v1.1.0.md | 产品需求文档（本文件） | ✅ |
| API_CONTRACT.md | API接口契约 | ✅ |
| README.md | 项目快速开始指南 | ✅ |
| WEB_FRONTEND_REQUIREMENTS.md | 小程序前端需求 | ✅ |
| DEPLOYMENT_CHECKLIST.md | 部署检查清单 | ✅ |
| AGENTS.md | AI助手使用规范 | ✅ |
| docs/database_schema.md | 数据库设计文档 | ✅ |
| docs/usage_guide.md | 用户使用指南 | ✅ |

### 11.2 技术文档
- docs/ai_chat_system_design.md - AI对话系统设计
- docs/api_reference.md - API详细参考
- docs/smart_notification_implementation_summary.md - 智能通知实现总结
- docs/TECHNICAL_ARCHITECTURE.md - 技术架构文档

---

## 十二、版本对比与演进路线

### 12.1 v1.1.0 vs v1.2.0（分支）

| 功能特性 | v1.1.0 (main) | v1.2.0 (streak-habit-system) |
|---------|--------------|----------------------------|
| **习惯系统** | 基础版（连续天数） | 复杂版（状态机+中断恢复） |
| **行为教练** | ❌ 无 | ✅ 独立行为教练对话 |
| **智能通知** | 基础提醒 | 上下文感知通知 |
| **事件驱动** | ❌ 无 | ✅ EventBus事件系统 |
| **系统复杂度** | 低（易维护） | 高（功能丰富） |
| **适用场景** | 生产部署 | 探索/大B客户 |

### 12.2 演进路线

**v1.1.x 系列（当前）**
- v1.1.1: 完善运营分析功能
- v1.1.2: 增强智能通知条件触发
- v1.1.3: 性能优化和缓存增强

**v1.2.x 系列（规划中）**
- 从 streak-habit-system 分支合并复杂习惯系统
- 根据用户反馈决定是否进入主干

---

## 十三、附录

### 13.1 术语表
- **BMR**: 基础代谢率（Basal Metabolic Rate）
- **TDEE**: 每日总能量消耗（Total Daily Energy Expenditure）
- **Agent**: AI助手，用户的体重管理伙伴
- **用户画像**: 用户的长期记忆和个性化配置
- **结构化消息**: 包含类型、内容、操作的数据格式
- **Streak**: 连续打卡天数

### 13.2 相关链接
- **GitHub仓库**: https://github.com/FelixWang119/WeightManagementAgent
- **streak-habit-system分支**: https://github.com/FelixWang119/WeightManagementAgent/tree/streak-habit-system
- **API文档**: http://localhost:8000/docs (本地运行后)

### 13.3 联系方式
- **开发**: Felix Wang
- **产品**: AI健康伙伴团队
- **更新周期**: 按需更新

---

**文档维护**: 本PRD基于v1.1.0版本实际代码整理，反映当前系统的真实功能状态。功能变更时请及时更新本文档。

**最后更新**: 2026-02-18  
**文档版本**: 2.0  
**适用代码版本**: v1.1.0 (commit: a31eeff)
