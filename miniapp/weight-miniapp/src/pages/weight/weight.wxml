<!-- ä½“é‡è®°å½•é¡µé¢ -->
<view class="container">
  <!-- å½“å‰ä½“é‡å¡ç‰‡ -->
  <view class="card">
    <view class="card-title">
      <text class="card-title-icon">âš–ï¸</text>
      <text>{{latestWeight ? 'å½“å‰ä½“é‡' : 'è®°å½•ä½“é‡'}}</text>
    </view>
    
    <view class="weight-display" wx:if="{{latestWeight}}">
      <text class="weight-number">{{latestWeight.weight}}</text>
      <text class="weight-unit">kg</text>
      <text class="weight-date">{{latestWeight.date}}</text>
    </view>
    
    <view class="weight-input-section">
      <view class="input-group">
        <text class="input-label">ä½“é‡ (kg)</text>
        <input 
          type="digit" 
          class="weight-input" 
          placeholder="ä¾‹: 65.5"
          bindinput="onWeightInput"
          value="{{inputWeight}}"
        />
      </view>
      
      <view class="input-group">
        <text class="input-label">ä½“è„‚ç‡ (%)</text>
        <input 
          type="digit" 
          class="weight-input" 
          placeholder="å¯é€‰"
          bindinput="onBodyFatInput"
          value="{{inputBodyFat}}"
        />
      </view>
      
      <view class="input-group">
        <text class="input-label">å¤‡æ³¨</text>
        <textarea 
          class="note-input" 
          placeholder="è®°å½•ä¸€ä¸‹ä»Šå¤©çš„çŠ¶æ€..."
          bindinput="onNoteInput"
          value="{{inputNote}}"
          maxlength="200"
        />
      </view>
      
      <button 
        class="btn-primary" 
        bindtap="recordWeight"
        disabled="{{!inputWeight || isRecording}}"
        loading="{{isRecording}}"
      >
        {{latestWeight ? 'æ›´æ–°è®°å½•' : 'è®°å½•ä½“é‡'}}
      </button>
    </view>
  </view>

  <!-- ä½“é‡è¶‹åŠ¿ -->
  <view class="card" wx:if="{{weightTrend.length > 1}}">
    <view class="card-title">
      <text class="card-title-icon">ğŸ“ˆ</text>
      <text>7å¤©è¶‹åŠ¿</text>
    </view>
    
    <view class="trend-summary">
      <text class="trend-text {{trendDirection === 'down' ? 'text-success' : trendDirection === 'up' ? 'text-danger' : ''}}">
        {{trendText}}
      </text>
      <text class="trend-change">{{trendChange}}kg</text>
    </view>
    
    <view class="trend-chart">
      <!-- è¿™é‡Œå¯ä»¥é›†æˆå›¾è¡¨ç»„ä»¶ -->
      <view class="chart-placeholder">
        <text>è¶‹åŠ¿å›¾è¡¨ï¼ˆå¯é›†æˆ EChartsï¼‰</text>
      </view>
    </view>
  </view>

  <!-- å†å²è®°å½• -->
  <view class="card">
    <view class="card-title">
      <text class="card-title-icon">ğŸ“‹</text>
      <text>å†å²è®°å½•</text>
      <text class="view-more" bindtap="toggleHistory">
        {{showAllHistory ? 'æ”¶èµ·' : 'æŸ¥çœ‹å…¨éƒ¨'}}
      </text>
    </view>
    
    <view class="history-list">
      <view class="history-item" wx:for="{{displayHistory}}" wx:for-item="record" wx:key="id">
        <view class="history-date">
          <text class="date-text">{{record.date}}</text>
          <text class="time-text">{{record.time}}</text>
        </view>
        <view class="history-weight">
          <text class="weight-value">{{record.weight}}kg</text>
          <text wx:if="{{record.body_fat}}" class="body-fat">ä½“è„‚ {{record.body_fat}}%</text>
        </view>
        <text wx:if="{{record.note}}" class="history-note">{{record.note}}</text>
      </view>
    </view>
    
    <view class="empty-state" wx:if="{{!weightHistory || weightHistory.length === 0}}">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">è¿˜æ²¡æœ‰ä½“é‡è®°å½•</text>
      <text class="empty-hint">å¼€å§‹è®°å½•ä½ çš„ä½“é‡å˜åŒ–å§</text>
    </view>
  </view>

  <!-- åº•éƒ¨å ä½ -->
  <view style="height: 40rpx;"></view>
</view>